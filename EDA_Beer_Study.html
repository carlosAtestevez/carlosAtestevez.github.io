<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Carlos Estevez" />

<meta name="date" content="2023-02-17" />

<title>EDA_Beer_Study.knit</title>

<script src="site_libs/header-attrs-2.19/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="bootstrap.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Carlos Estevez</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">About Me</a>
</li>
<li>
  <a href="EDA_Beer_Study.html">Beer Study</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<style>
body {
  background-color: azure;
}
</style>
<div class="alert alert-dismissible alert-warning">
<br>
<h2>
<strong>EDA Analysis Beer and Breweries across the United
States</strong>
</h2>
<h3>
<strong>Introduction</strong>
</h3>
<p>In this EDA(Exploratory Data Analysis) we will conduct an analysis of
beers sold across the United States. In addition, we will show deep
analysis across different beer names, styles, and companies to shed more
light into some of the weakness and advantages of certain business
strategies.</p>
This analysis will be presented to the Budweiser corporation. We will
analyze and investigate data sets and summarize their main
characteristics, often employing data visualization methods to be more
compressive. Our main goal will be to recognize the areas where the
company can focus aiming to strengthen its position in the market and
ultimately translate these benefits to the final customer.
<p>
<div class="figure">
<img
src="https://cdn.shoplightspeed.com/shops/614088/files/44566076/anheuser-busch-budweiser-lager-6pk-12oz-bottles.jpg"
alt="" />
<p class="caption">Image 1: Logo Budweiser</p>
</div>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Loading the libraries we will use for carrying out the
EDA</strong>
</h3>
<pre class="r"><code>library(tidyverse)
library(stringr)
library(caret)
library(plotly)
library(ggthemes)
library(GGally)
library(class)
library(e1071)
library(maps)
library(usmap)</code></pre>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Retrieving data from CSV files</strong>
</h3>
<div class="alert alert-dismissible alert-info">
<p><button type="button" class="close" data-dismiss="alert">×</button>
<strong>It is very important to update the working directory once you
download the project!</strong></p>
</div>
<pre class="r"><code>##Setting the working directory
#setwd(&quot;C:/Users/cestevez/Dropbox/Cloud PC/Thinkpad/Thinkpad Desktop/Master Data Science SMU/Class_Sessions/Data Science Sessions/Repository/SMU_DS_6306_EDA_1&quot;)


#Reading the Beers dataset
df_beers = read.csv(&quot;Beers.csv&quot;,header = TRUE)
#Reading the brewery dataset
df_breweries_1 = read.csv(&quot;Breweries.csv&quot;,header = TRUE)
df_states = read.csv(&quot;States.csv&quot;,header=TRUE)
df_breweries_1$State = str_trim(df_breweries_1$State)
df_breweries_2 = merge(df_breweries_1,df_states,by = &quot;State&quot;)</code></pre>
</div>
<div class="alert alert-dismissible alert-warning">

<h3>
<strong>Data Cleansing and Setting global variables</strong>
</h3>
<p>
<h4>
<strong>Addressing the missing values in each column</strong>
</h4>
</p>
<p>
In this section, we will perform data cleansing. Data Cleaning is one of
the important steps in EDA. Data cleaning can be done in many ways. One
of them is handling missing values We will implement different methods
for IBU and ABV - ABV: Replace missing values with the arithmetic mean -
IBU: Replace missing values using KnnImputation method
</p>
<p>
<pre class="r"><code>#Cleaning ABV using mean
df_beers_cl0 = df_beers
nr_mean_abv = mean(df_beers_cl0[!is.na(df_beers_cl0$ABV),]$ABV) #Calculate the mean
length_abv = length(df_beers_cl0[is.na(df_beers_cl0$ABV),]$ABV) 
if(length_abv &gt; 0){
  df_beers_cl0[is.na(df_beers_cl0$ABV),]$ABV = nr_mean_abv      #Replacing Missing value with mean
}

#Cleaning IBU using mean
df_beers_cl1 = df_beers
nr_mean_ibu = mean(df_beers_cl1[!is.na(df_beers_cl1$IBU),]$IBU)
length_ibu = length(df_beers_cl1[is.na(df_beers_cl1$IBU),]$IBU)
if(length_ibu &gt; 0){
  df_beers_cl1[is.na(df_beers_cl1$IBU),]$IBU = nr_mean_ibu
}


#Cleaning using KnnInpute
##Creating the model K = 20
knn_imp_model &lt;- preProcess(df_beers_cl0 %&gt;% 
                          select(ABV,IBU),
                            method = c(&quot;knnImpute&quot;),
                            k = 20,
                            knnSummary = mean)


#Running the model
df_beers_unp &lt;- predict(knn_imp_model, df_beers_cl0,na.action = na.pass)
#The beer data set will be normalized. To de-normalize and get the original data back:
procNames &lt;- data.frame(col = names(knn_imp_model$mean), mean = knn_imp_model$mean, sd = knn_imp_model$std)
for(i in procNames$col){
 df_beers_unp[i] &lt;- df_beers_unp[i]*knn_imp_model$std[i]+knn_imp_model$mean[i] 
}


#Plotting IBU before data cleansing
nr_rows = dim(df_beers)[1]
df_beers  %&gt;% ggplot(aes(x=IBU))+geom_histogram(fill=&quot;black&quot;,binwidth = 3)+
  labs(title=&quot;IBU before performing data cleansing&quot;,x=&quot;IBU(International bitterness Unit)&quot;,y=&quot;Observation number&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/DataCleanandModel-1.png" width="672" /></p>
<pre class="r"><code>#Plotting ABV before data cleansing
df_beers  %&gt;% ggplot(aes(x=ABV))+geom_histogram(fill=&quot;black&quot;)+
  labs(title=&quot;ABV before performing data cleansing&quot;,x=&quot;ABV(Alcohol by Volume)&quot;,y=&quot;Observation number&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/DataCleanandModel-2.png" width="672" /></p>
<pre class="r"><code>#Plotting IBU using Mean 
df_beers_cl1  %&gt;% ggplot(aes(x=IBU))+geom_histogram(fill=&quot;blue&quot;)+
  labs(title=&quot;IBU after performing data cleansing&quot;,subtitle = &quot;Calculation using Mean&quot;,x=&quot;IBU(International bitterness Unit)&quot;,y=&quot;Observation number&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/DataCleanandModel-3.png" width="672" /></p>
<pre class="r"><code>#Plotting IBU KNNImputation and ABV after data cleansing
df_beers_unp  %&gt;% ggplot(aes(x=IBU))+geom_histogram(fill=&quot;blue&quot;,col=&quot;black&quot;,binwidth = 3)+labs(title=&quot;IBU after performing data cleansing&quot;,subtitle = &quot;Calculation using KnnImputation&quot;,x=&quot;IBU(International bitterness Unit)&quot;,y=&quot;Observation number&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/DataCleanandModel-4.png" width="672" /></p>
<pre class="r"><code>#Plotting ABV after data cleansing
df_beers_unp  %&gt;% ggplot(aes(x=ABV))+geom_histogram(fill=&quot;blue&quot;,col=&quot;black&quot;)+labs(title=&quot;ABV after performing data cleansing&quot;,x=&quot;ABV(Alcohol by Volume)&quot;,y=&quot;Observation number&quot;)+geom_density(lwd = 1.2,
               linetype = 2,
               colour = 2)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/DataCleanandModel-5.png" width="672" /></p>
<pre class="r"><code>#Merging Beers and Breweries datasets
df_beerbre_unp = merge(df_beers_unp,df_breweries_2,by.x = &quot;Brewery_id&quot;,by.y = &quot;Brew_ID&quot;)
df_beerbre_unp_1 = filter(df_beerbre_unp,str_detect(df_beerbre_unp$Style,regex(&quot;IPA|ALE&quot;,ignore_case = TRUE)))
df_beerbre_unp_1 = mutate(df_beerbre_unp_1,Type= ifelse(str_detect(Style,regex(&quot;IPA&quot;,ignore_case = TRUE)),&quot;IPA&quot;,&quot;ALE&quot;))
df_beerbre_unp_2 = mutate(df_beerbre_unp,Type = ifelse(str_detect(Style,regex(&quot;IPA&quot;,ignore_case = TRUE)),&quot;IPA&quot;,ifelse(str_detect(Style,regex(&quot;ALE&quot;,ignore_case = TRUE)),&quot;ALE&quot;,&quot;OTHERS&quot;)))


#Dataframe Map by State
df_usa_states_0 = usmapdata::centroid_labels(&quot;states&quot;)
#Dataframe Map by State
df_usa_states_1 = map_data(&quot;state&quot;)


###Number of beer by state(Top 5)
df_berbrew_bystate_0 = group_by(df_beerbre_unp,Brewery_id,Name.y,State) %&gt;% summarize(count_beer = n()) %&gt;% arrange(desc(count_beer)) %&gt;% head(n=5)
df_berbrew_bystate_1 = merge(df_berbrew_bystate_0,df_usa_states_0,by.x = &quot;State&quot;,by.y = &quot;abbr&quot;)

###Median IBU and ABV by State
df_avg_ibuabv_bystate = df_beerbre_unp %&gt;% group_by(State,Name_State) %&gt;% summarize(Median_ABV = mean(ABV),Median_IBU = mean(IBU))

#The Higest IBU and ABV by State
df_habv_bystate_0 = arrange(df_beerbre_unp,desc(ABV)) %&gt;% head(n = 1)
df_habv_bystate_1 = arrange(df_beerbre_unp,desc(ABV)) %&gt;% head(n = 5)
df_hibu_bystate_0 = arrange(df_beerbre_unp,desc(IBU)) %&gt;% head(n = 5)
df_habv_bystate_1 = merge(df_habv_bystate_1,df_usa_states_0,by.x = &quot;State&quot;,by.y = &quot;abbr&quot;)
df_hibu_bystate_0 = merge(df_hibu_bystate_0,df_usa_states_0,by.x = &quot;State&quot;,by.y = &quot;abbr&quot;)



df_beerbre_fil0 = filter(df_beerbre_unp,str_detect(df_beerbre_unp$Style,regex(&quot;IPA|ALE&quot;,ignore_case = TRUE)))


#We create the column Type for classifying IPA Beer Styles and the Rest
df_beerbre_fil1 = mutate(df_beerbre_fil0,Type= ifelse(str_detect(Style,regex(&quot;IPA&quot;,ignore_case = TRUE)),&quot;IPA&quot;,&quot;ALE&quot;))

df_beerbre_fil2 = mutate(df_beerbre_unp,Type = ifelse(str_detect(Style,regex(&quot;IPA&quot;,ignore_case = TRUE)),&quot;IPA&quot;,ifelse(str_detect(Style,regex(&quot;ALE&quot;,ignore_case = TRUE)),&quot;ALE&quot;,&quot;OTHERS&quot;)))


#We accomulate the number of beers by style but only the most popular(Beer styles with more than five beers)
df_pobeers_bystate = group_by(df_beerbre_unp,State,Name_State,Style) %&gt;% summarize(count_style = n()) %&gt;% filter(count_style&gt;5) %&gt;% mutate(Name_State_2=str_trim(str_to_lower(Name_State)))

df_pobeers_bystate_1 = group_by(df_beerbre_unp,State,Name_State) %&gt;% summarize(count_style = n()) %&gt;% mutate(Name_State_2=str_trim(str_to_lower(Name_State))) </code></pre>
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
After replacing the missing values of both variables(ABV and IBU) the
resulting data distribution looks very similar to the initial
distribution. The most challenging was the IBU activity because of the
large number of observations(1005). In the end, the Knn process was very
effective and the results look very good in the plot.
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the number of breweries by state</strong>
</h3>
<pre class="r"><code>df_brewerybystate=table(df_breweries_2$State)
df_brewerybystate= data.frame(df_brewerybystate)
colnames(df_brewerybystate)[1]=&quot;state&quot;
df_brewerybystate$Freq=as.double(df_brewerybystate$Freq)
df_brewerybystate$state=as.character(df_brewerybystate$state)
df_brewerybystate$state=str_replace_all(df_brewerybystate$state,&quot; &quot;,&quot;&quot;)

#Plotting the map
plot_usmap(data = df_brewerybystate, regions = &quot;state&quot;, values = &quot;Freq&quot;, color = &quot;#56B4E9&quot;,labels = TRUE,label_color = &quot;#E69F00&quot;) + 
  scale_fill_continuous(
    low = &quot;white&quot;, high = &quot;red&quot;, name = &quot;Number of Brewery&quot;, label = scales::comma
  ) + theme(legend.position = &quot;right&quot;)+labs(title = &quot;Number of Breweries by State&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/SummarizingbyState-1.png" width="672" /></p>
<pre class="r"><code>knitr::kable(
  df_brewerybystate,
  caption = &quot;Number of Breweries by State&quot;
)</code></pre>
<table>
<caption>Number of Breweries by State</caption>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">Freq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AK</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">AL</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">AR</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">AZ</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">CA</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">CO</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="left">CT</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">DC</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">DE</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">FL</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">GA</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">HI</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">IA</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">ID</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">IL</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">IN</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="left">KS</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">KY</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="left">LA</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="left">MA</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">MD</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">ME</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">MI</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">MN</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">MO</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">MS</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">MT</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">NC</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="left">ND</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">NE</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">NH</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">NJ</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">NM</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">NV</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">NY</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">OH</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">OK</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="left">OR</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left">PA</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="left">RI</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">SC</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">SD</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">TN</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">TX</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">UT</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">VA</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="left">VT</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">WA</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="left">WI</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">WV</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">WY</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
This analysis is very meaningful because Budweiser can design marketing
and advertising strategies in the states with a larger number of
breweries like California and Colorado.
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the top Breweries(The Big 5)</strong>
</h3>
<pre class="r"><code>dfl_berbrew_bystate_1=data.frame(df_berbrew_bystate_1$Name.y,df_berbrew_bystate_1$State,df_berbrew_bystate_1$x,df_berbrew_bystate_1$y,df_berbrew_bystate_1$count_beer)
colnames(dfl_berbrew_bystate_1)=c(&quot;company&quot;,&quot;state&quot;,&quot;lon&quot;,&quot;lat&quot;,&quot;n&quot;)

plot_usmap(data = dfl_berbrew_bystate_1, regions = &quot;state&quot;, values = &quot;n&quot;, fill=&quot;indianred&quot;,color = &quot;lemonchiffon&quot;,labels = TRUE,label_color = &quot;#E69F00&quot;) +  ggrepel::geom_label_repel(data = dfl_berbrew_bystate_1,aes(x = lon, y = lat, label =company),
                            size = 3, alpha = 0.8,
                            label.r = unit(0.5, &quot;lines&quot;), label.size = 0.5,
                            segment.color = &quot;black&quot;, segment.size = 1)+geom_point(data = dfl_berbrew_bystate_1,
                                                    aes(x = lon, y = lat, size = n),
                                                    color = &quot;navyblue&quot;, alpha = 0.5)+scale_size_continuous(range = c(5, 10),name = &quot;Number of American IPA&quot;, label = scales::comma)+theme(legend.position = &quot;right&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/TopFiveBewUsa-1.png" width="672" /></p>
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
This analysis is also very meaningful. They can improve customer service
in the breweries with the highest Customer Demand. In that sense, They
might increase the sales demand by offering better services in these
areas.
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the median ABV and IBU by state</strong>
</h3>
<pre class="r"><code>ggplot(df_avg_ibuabv_bystate, aes(x = State, y = Median_ABV, fill = Median_IBU)) + 
  geom_col() +
  ggtitle(&quot;Median ABV and IBU by State&quot;) +
  xlab(&quot;State&quot;) +
  ylab(&quot;Median ABV&quot;) +
  scale_fill_gradient(low = &quot;blue&quot;, high = &quot;red&quot;, name=&quot;Median IBU&quot;) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))</code></pre>
<img src="EDA_Beer_Study_files/figure-html/Median_Beer_Brewer-1.png" width="672" />
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
This analysis can be very strategic too. Budweiser can allocate beer
types according to different Consumer tastes and preferences. For
example, the people in Kansas prefer drinks with a low level of alcohol,
Budweiser can negotiate better conditions with the breweries in Kansas
in order to have more stock of drinks with a lower level of ABV aiming
to meet the customer demand
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the states with the highest ABV and IBU
beers</strong>
</h3>
<pre class="r"><code>dfl_top_abv = data.frame(state = df_habv_bystate_1$State,ABV = df_habv_bystate_1$ABV,lat=df_habv_bystate_1$y,lon=df_habv_bystate_1$x,City=df_habv_bystate_1$City)

dfl_top_ibu = data.frame(state = df_hibu_bystate_0$State,IBU = df_hibu_bystate_0$IBU,lat=df_hibu_bystate_0$y,lon=df_hibu_bystate_0$x,City=df_hibu_bystate_0$City)

#plot top 5 state that has the most ABV beer
plot_usmap(data = dfl_top_abv, regions = &quot;state&quot;, values = &quot;ABV&quot;, color = &quot;#56B4E9&quot;,labels = TRUE,label_color = &quot;#E69F00&quot;) + 
  scale_fill_continuous(
    low = &quot;white&quot;, high = &quot;red&quot;, name = &quot;Maximum Alcoholic (ABV)&quot;, label = scales::comma
  ) + theme(legend.position = &quot;left&quot;)+ggrepel::geom_label_repel(data = dfl_top_abv,
             aes(x = lon, y = lat, label = City),size = 3, alpha = 0.8,
             label.r = unit(0.5, &quot;lines&quot;), label.size = 0.5,
             segment.color = &quot;black&quot;, segment.size = 1)+labs(title = &quot;Analysis of the states with highest ABV&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/TopStateABVIBU-1.png" width="672" /></p>
<pre class="r"><code>#plot top 5 state that has the most IBU beer
plot_usmap(data = dfl_top_ibu, regions = &quot;state&quot;, values = &quot;IBU&quot;, color = &quot;#56B4E9&quot;,labels = TRUE,label_color = &quot;#E69F00&quot;) + 
  scale_fill_continuous(
    low = &quot;white&quot;, high = &quot;purple&quot;, name = &quot;Maximum Alcoholic (IBU)&quot;, label = scales::comma
  ) + theme(legend.position = &quot;left&quot;)+ggrepel::geom_label_repel(data = dfl_top_ibu,
             aes(x = lon, y = lat, label = City),size = 3, alpha = 0.8,
             label.r = unit(0.5, &quot;lines&quot;), label.size = 0.5,
             segment.color = &quot;black&quot;, segment.size = 1)+labs(title = &quot;Analysis of the states with highest IBU&quot;)</code></pre>
<img src="EDA_Beer_Study_files/figure-html/TopStateABVIBU-2.png" width="672" />
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
This analysis can reinforce the previous analysis. Again, Budweiser can
allocate beer types according to the different Consumer tastes and
preferences aiming to atract more clients and increase the sales
revenue. We can see from the map that Colorado is a state with a high
level of ABV preference. Budweiser can lunch more IPA beers(Higher level
of ABV and IBU) in this state and increment sales..
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the ABV variable and data distribution</strong>
</h3>
<pre class="r"><code>df_beerbre_unp_2 %&gt;%select(IBU,ABV,Type)%&gt;%
  ggpairs(aes(color=Type))</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/SummaryStatsABV-1.png" width="672" /></p>
<pre class="r"><code>df_beers_unp  %&gt;% ggplot(aes(x=ABV))+geom_histogram(fill=&quot;blue&quot;,col=&quot;black&quot;)+labs(title=&quot;ABV Histogram&quot;,x=&quot;ABV(Alcohol by Volume)&quot;,y=&quot;Observation number&quot;)+geom_density(lwd = 1.2,
               linetype = 2,
               colour = 2)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/SummaryStatsABV-2.png" width="672" /></p>
<pre class="r"><code>df_beerbre_unp %&gt;% ggplot(aes(x=ABV,fill=State))+geom_histogram()+labs(title=&quot;ABV Histogram&quot;,x=&quot;ABV(Alcohol by Volume)&quot;,y=&quot;Observation number&quot;)+geom_density(lwd = 1.2,
            
               colour = 2)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/SummaryStatsABV-3.png" width="672" /></p>
<pre class="r"><code>skewness(df_beerbre_unp$ABV)</code></pre>
<pre><code>## [1] 0.9698248</code></pre>
<pre class="r"><code>kurtosis(df_beerbre_unp$ABV)</code></pre>
<pre><code>## [1] 1.245737</code></pre>
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
ABV has a moderately right skewed distribution for following reasons
<ul>
<li>
The Mean is slightly greater than the Median
<li>
Skewness is BT 0.5 and 1
<li>
A normal distribution has a kurtosis of 3 and ABV kurtosis is less than
3
</ul>
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the relationship between ABV and IBU</strong>
</h3>
<pre class="r"><code>df_beerbre_unp %&gt;% select(IBU,ABV) %&gt;% ggpairs(columnLabels = c(&quot;ABV&quot;,&quot;IBU&quot;))+
  labs(title=&quot;Relationship between the bitterness of the beer(IBU) and its alcoholic content(ABV)&quot;)</code></pre>
<img src="EDA_Beer_Study_files/figure-html/RelationShipIBUABV-1.png" width="672" />
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
Relationship between IBU and ABV
<ul>
<li>
Strong positive linear relationship between IBU and ABV
<li>
The correlation coefficient(Close to 1) also confirms the linear
relationship
</ul>
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of IPA and ALE beers in terms of IBU and ABV</strong>
</h3>
<p>
When it comes down to it, a Pale Ale should have a nice hop character
but medium build, whereas IPAs tend to have higher ABV and IBU.
</p>
<pre class="r"><code>#We plot the relationship between IBU and ABV by Beer Type
df_beerbre_unp_1 %&gt;% ggplot(aes(x=ABV,y=IBU,color=Type))+geom_point()+
  labs(title = &quot;Relationship IBU and AVB&quot;,subtitle = &quot;Relationship IBU/AVB by Beer Type&quot;)+xlab(&quot;Alcohol by Volume (ABV)&quot;)+ylab(&quot;International Bitterness Unit(IBU)&quot;)</code></pre>
<p><img src="EDA_Beer_Study_files/figure-html/DifferenceIPAPALE-1.png" width="672" /></p>
<pre class="r"><code>#Initializing the model
nr_percentage = 0.7
nr_observations = nrow(df_beerbre_fil1)
nr_k = 5

#Creating the training and Testing dataset
lst_index_beer = sample(nr_observations,round(nr_observations * nr_percentage))
df_train = df_beerbre_fil1[lst_index_beer,]
df_test = df_beerbre_fil1[-lst_index_beer,]

#Running the model
knn_result = knn(df_train[,c(4,5)],df_test[,c(4,5)],df_train$Type,prob = TRUE,k=nr_k)
co_table =  table(knn_result,df_test$Type)
confusionMatrix(co_table)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           
## knn_result ALE IPA
##        ALE 259  39
##        IPA  39 136
##                                           
##                Accuracy : 0.8351          
##                  95% CI : (0.7985, 0.8674)
##     No Information Rate : 0.63            
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.6463          
##                                           
##  Mcnemar&#39;s Test P-Value : 1               
##                                           
##             Sensitivity : 0.8691          
##             Specificity : 0.7771          
##          Pos Pred Value : 0.8691          
##          Neg Pred Value : 0.7771          
##              Prevalence : 0.6300          
##          Detection Rate : 0.5476          
##    Detection Prevalence : 0.6300          
##       Balanced Accuracy : 0.8231          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
As we can see from the image the observations of the IPA beer types have
higher levels of bitterness and alcohol. The opposite is also true. The
ALE Beer Types have fewer levels of IBU and ABV. The KNN accuracy also
is very high. That means there’s a clear difference between IPA beers
and the rest
</p>
</div>
<div class="alert alert-dismissible alert-warning">
<h3>
<strong>Analysis of the most popular states in terms of beer types and
the most popular beer stype across the United States</strong>
</h3>
<pre class="r"><code>#Plotting the Popular Beer Style by State x= Style, Y = Count of beer , color = Name of the State
gfr = df_pobeers_bystate %&gt;% arrange(Name_State) %&gt;% ggplot(aes(x=Style,y=count_style,fill = Name_State ))+geom_bar(stat = &quot;identity&quot;,position = &quot;stack&quot;)+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),legend.position = &quot;left&quot;,text = element_text(size = 10))+labs(title = &quot;Most popular beer style in USA by State&quot;,subtitle = &quot;Style with a very few beers are not shown in this analysis&quot;)+xlab(&quot;USA State&quot;)+ylab(&quot;Number of Beers by Style&quot;)
ggplotly(gfr)</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6ba34a12a93ca7ffbfe9" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6ba34a12a93ca7ffbfe9">{"x":{"data":[{"orientation":"v","width":0.9,"base":348,"x":[6],"y":[7],"text":"Style: American IPA<br />count_style:  7<br />Name_State: Alaska","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Alaska","legendgroup":"Alaska","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[63,339],"x":[2,6],"y":[6,9],"text":["Style: American Amber / Red Ale<br />count_style:  6<br />Name_State: Arizona","Style: American IPA<br />count_style:  9<br />Name_State: Arizona"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(236,130,60,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Arizona","legendgroup":"Arizona","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999],"base":[52,33,45,294,162,0,0],"x":[2,3,5,6,7,15,17],"y":[11,7,11,45,17,6,7],"text":["Style: American Amber / Red Ale<br />count_style: 11<br />Name_State: California","Style: American Blonde Ale<br />count_style:  7<br />Name_State: California","Style: American Double / Imperial IPA<br />count_style: 11<br />Name_State: California","Style: American IPA<br />count_style: 45<br />Name_State: California","Style: American Pale Ale (APA)<br />count_style: 17<br />Name_State: California","Style: Cream Ale<br />count_style:  6<br />Name_State: California","Style: Kölsch<br />count_style:  7<br />Name_State: California"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(221,141,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"California","legendgroup":"California","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[33,22,6,31,254,122,8,34,9,0,0],"x":[2,3,4,5,6,7,8,9,10,11,16],"y":[19,11,7,14,40,40,6,8,6,8,7],"text":["Style: American Amber / Red Ale<br />count_style: 19<br />Name_State: Colorado","Style: American Blonde Ale<br />count_style: 11<br />Name_State: Colorado","Style: American Brown Ale<br />count_style:  7<br />Name_State: Colorado","Style: American Double / Imperial IPA<br />count_style: 14<br />Name_State: Colorado","Style: American IPA<br />count_style: 40<br />Name_State: Colorado","Style: American Pale Ale (APA)<br />count_style: 40<br />Name_State: Colorado","Style: American Pale Lager<br />count_style:  6<br />Name_State: Colorado","Style: American Pale Wheat Ale<br />count_style:  8<br />Name_State: Colorado","Style: American Porter<br />count_style:  6<br />Name_State: Colorado","Style: American Stout<br />count_style:  8<br />Name_State: Colorado","Style: Czech Pilsener<br />count_style:  7<br />Name_State: Colorado"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(202,151,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Colorado","legendgroup":"Colorado","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[235,115],"x":[6,7],"y":[19,7],"text":["Style: American IPA<br />count_style: 19<br />Name_State: Florida","Style: American Pale Ale (APA)<br />count_style:  7<br />Name_State: Florida"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(179,160,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Florida","legendgroup":"Florida","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":229,"x":[6],"y":[6],"text":"Style: American IPA<br />count_style:  6<br />Name_State: Idaho","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(151,169,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Idaho","legendgroup":"Idaho","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999],"base":[22,217,99,28],"x":[5,6,7,9],"y":[9,12,16,6],"text":["Style: American Double / Imperial IPA<br />count_style:  9<br />Name_State: Illinois","Style: American IPA<br />count_style: 12<br />Name_State: Illinois","Style: American Pale Ale (APA)<br />count_style: 16<br />Name_State: Illinois","Style: American Pale Wheat Ale<br />count_style:  6<br />Name_State: Illinois"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(113,176,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Illinois","legendgroup":"Illinois","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999],"base":[16,191,86,0],"x":[3,6,7,10],"y":[6,26,13,9],"text":["Style: American Blonde Ale<br />count_style:  6<br />Name_State: Indiana","Style: American IPA<br />count_style: 26<br />Name_State: Indiana","Style: American Pale Ale (APA)<br />count_style: 13<br />Name_State: Indiana","Style: American Porter<br />count_style:  9<br />Name_State: Indiana"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(47,182,0,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Indiana","legendgroup":"Indiana","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":172,"x":[6],"y":[19],"text":"Style: American IPA<br />count_style: 19<br />Name_State: Massachusetts","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,187,75,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Massachusetts","legendgroup":"Massachusetts","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999,0.899999999999999],"base":[22,0,152,79,0,0,8,9,0],"x":[2,4,6,7,12,13,14,18,20],"y":[11,6,20,7,7,8,13,7,7],"text":["Style: American Amber / Red Ale<br />count_style: 11<br />Name_State: Michigan","Style: American Brown Ale<br />count_style:  6<br />Name_State: Michigan","Style: American IPA<br />count_style: 20<br />Name_State: Michigan","Style: American Pale Ale (APA)<br />count_style:  7<br />Name_State: Michigan","Style: Belgian Dark Ale<br />count_style:  7<br />Name_State: Michigan","Style: Belgian IPA<br />count_style:  8<br />Name_State: Michigan","Style: Cider<br />count_style: 13<br />Name_State: Michigan","Style: Saison / Farmhouse Ale<br />count_style:  7<br />Name_State: Michigan","Style: Witbier<br />count_style:  7<br />Name_State: Michigan"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,118,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Michigan","legendgroup":"Michigan","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":141,"x":[6],"y":[11],"text":"Style: American IPA<br />count_style: 11<br />Name_State: Minnesota","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,192,152,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Minnesota","legendgroup":"Minnesota","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":132,"x":[6],"y":[9],"text":"Style: American IPA<br />count_style:  9<br />Name_State: Missouri","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,192,183,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Missouri","legendgroup":"Missouri","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":124,"x":[6],"y":[8],"text":"Style: American IPA<br />count_style:  8<br />Name_State: Montana","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,189,209,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Montana","legendgroup":"Montana","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[113,73],"x":[6,7],"y":[11,6],"text":["Style: American IPA<br />count_style: 11<br />Name_State: New York","Style: American Pale Ale (APA)<br />count_style:  6<br />Name_State: New York"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,183,232,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"New York","legendgroup":"New York","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[104,64],"x":[6,7],"y":[9,9],"text":["Style: American IPA<br />count_style:  9<br />Name_State: North Carolina","Style: American Pale Ale (APA)<br />count_style:  9<br />Name_State: North Carolina"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,174,250,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"North Carolina","legendgroup":"North Carolina","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[95,57],"x":[6,7],"y":[9,7],"text":["Style: American IPA<br />count_style:  9<br />Name_State: Ohio","Style: American Pale Ale (APA)<br />count_style:  7<br />Name_State: Ohio"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(61,161,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Ohio","legendgroup":"Ohio","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999],"base":[12,10,16,71,44,13,0],"x":[2,3,5,6,7,9,14],"y":[10,6,6,24,13,15,8],"text":["Style: American Amber / Red Ale<br />count_style: 10<br />Name_State: Oregon","Style: American Blonde Ale<br />count_style:  6<br />Name_State: Oregon","Style: American Double / Imperial IPA<br />count_style:  6<br />Name_State: Oregon","Style: American IPA<br />count_style: 24<br />Name_State: Oregon","Style: American Pale Ale (APA)<br />count_style: 13<br />Name_State: Oregon","Style: American Pale Wheat Ale<br />count_style: 15<br />Name_State: Oregon","Style: Cider<br />count_style:  8<br />Name_State: Oregon"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(143,145,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Oregon","legendgroup":"Oregon","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9],"base":[6,52,38],"x":[2,6,7],"y":[6,19,6],"text":["Style: American Amber / Red Ale<br />count_style:  6<br />Name_State: Pennsylvania","Style: American IPA<br />count_style: 19<br />Name_State: Pennsylvania","Style: American Pale Ale (APA)<br />count_style:  6<br />Name_State: Pennsylvania"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(190,128,255,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Pennsylvania","legendgroup":"Pennsylvania","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.9,0.9,0.899999999999999,0.899999999999999],"base":[0,0,6,40,25,7,0],"x":[2,3,5,6,7,9,18],"y":[6,10,10,12,13,6,9],"text":["Style: American Amber / Red Ale<br />count_style:  6<br />Name_State: Texas","Style: American Blonde Ale<br />count_style: 10<br />Name_State: Texas","Style: American Double / Imperial IPA<br />count_style: 10<br />Name_State: Texas","Style: American IPA<br />count_style: 12<br />Name_State: Texas","Style: American Pale Ale (APA)<br />count_style: 13<br />Name_State: Texas","Style: American Pale Wheat Ale<br />count_style:  6<br />Name_State: Texas","Style: Saison / Farmhouse Ale<br />count_style:  9<br />Name_State: Texas"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(222,113,249,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Texas","legendgroup":"Texas","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":0.9,"base":0,"x":[5],"y":[6],"text":"Style: American Double / Imperial IPA<br />count_style:  6<br />Name_State: Vermont","type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(242,101,231,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Vermont","legendgroup":"Vermont","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[30,18],"x":[6,7],"y":[10,7],"text":["Style: American IPA<br />count_style: 10<br />Name_State: Virginia","Style: American Pale Ale (APA)<br />count_style:  7<br />Name_State: Virginia"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(254,97,207,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Virginia","legendgroup":"Virginia","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9],"base":[9,7],"x":[6,7],"y":[21,11],"text":["Style: American IPA<br />count_style: 21<br />Name_State: Washington","Style: American Pale Ale (APA)<br />count_style: 11<br />Name_State: Washington"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,100,179,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Washington","legendgroup":"Washington","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.9,0.9,0.9,0.899999999999999,0.899999999999999,0.899999999999999],"base":[0,0,0,0,0,0],"x":[1,6,7,8,9,19],"y":[10,9,7,8,7,6],"text":["Style: American Adjunct Lager<br />count_style: 10<br />Name_State: Wisconsin","Style: American IPA<br />count_style:  9<br />Name_State: Wisconsin","Style: American Pale Ale (APA)<br />count_style:  7<br />Name_State: Wisconsin","Style: American Pale Lager<br />count_style:  8<br />Name_State: Wisconsin","Style: American Pale Wheat Ale<br />count_style:  7<br />Name_State: Wisconsin","Style: Vienna Lager<br />count_style:  6<br />Name_State: Wisconsin"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,108,146,1)","line":{"width":1.88976377952756,"color":"transparent"}},"name":"Wisconsin","legendgroup":"Wisconsin","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":42.1685346616853,"r":7.30593607305936,"b":186.56704026567,"l":40.1826484018265},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352},"title":{"text":"Most popular beer style in USA by State","font":{"color":"rgba(0,0,0,1)","family":"","size":15.9402241594022},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,20.6],"tickmode":"array","ticktext":["American Adjunct Lager","American Amber / Red Ale","American Blonde Ale","American Brown Ale","American Double / Imperial IPA","American IPA","American Pale Ale (APA)","American Pale Lager","American Pale Wheat Ale","American Porter","American Stout","Belgian Dark Ale","Belgian IPA","Cider","Cream Ale","Czech Pilsener","Kölsch","Saison / Farmhouse Ale","Vienna Lager","Witbier"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],"categoryorder":"array","categoryarray":["American Adjunct Lager","American Amber / Red Ale","American Blonde Ale","American Brown Ale","American Double / Imperial IPA","American IPA","American Pale Ale (APA)","American Pale Lager","American Pale Wheat Ale","American Porter","American Stout","Belgian Dark Ale","Belgian IPA","Cider","Cream Ale","Czech Pilsener","Kölsch","Saison / Farmhouse Ale","Vienna Lager","Witbier"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.6268161062682},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"USA State","font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-17.75,372.75],"tickmode":"array","ticktext":["0","100","200","300"],"tickvals":[0,100,200,300],"categoryorder":"array","categoryarray":["0","100","200","300"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.6268161062682},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Number of Beers by Style","font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.6268161062682},"title":{"text":"Name_State","font":{"color":"rgba(0,0,0,1)","family":"","size":13.2835201328352}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"8e431af7e0a":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"8e431af7e0a","visdat":{"8e431af7e0a":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>#We calculate the mean of every state in order to locate the Label in the center
df_usa_states_3 = df_usa_states_1 %&gt;% group_by(region) %&gt;% summarize(lat=mean(lat),long=mean(long)) %&gt;% mutate(AB_State = str_to_upper(str_sub(region,1,2)))

#Merge of the beer data and the coordinates and locations
df_state_beer_1 = merge(df_pobeers_bystate,df_usa_states_1,by.x = &quot;Name_State_2&quot;,by.y = &quot;region&quot;)
df_state_beer_2 = merge(df_usa_states_1,df_pobeers_bystate_1,by.x=&quot;region&quot;,by.y = &quot;Name_State_2&quot;)
df_state_beer_3 = merge(df_usa_states_3,df_pobeers_bystate_1,by.x=&quot;region&quot;,by.y = &quot;Name_State_2&quot;) 


#Plotting the MAP and The label of each state
map = df_usa_states_1 %&gt;% ggplot()+geom_polygon(aes(x=long, y=lat, group = group,fill=region))+
      theme(legend.position = &quot;none&quot;)+ggrepel::geom_label_repel(aes(x=long,   y=lat,label=sprintf(&quot;%s,Beers:%i&quot;,Name_State,count_style),alpha=0.8),size=2,data=df_state_beer_3)+
  labs(title = &quot;Number of Beer Types by States in USA&quot;,subtitle = &quot;Assorment of Beer Types by State in the USA&quot;)+xlab(&quot;Latitude&quot;)+ylab(&quot;Longitude&quot;)

map</code></pre>
<img src="EDA_Beer_Study_files/figure-html/AdditionalInformationEDA-2.png" width="672" />
<p>
<h4>
<strong>Conclusion</strong>
</h4>
</p>
<p>
The map shows the information about the number of beers or SKU by state
in the United States For example we can notice that state such as
California has a large number of beers by style 183 and states like
Dakota has only 3 beers by style This data will play an important role
in two different areas:
</p>
<ul>
<li>
Advertising strategy
<li>
Inventory management
</ul>
<p>
<p>It is a great idea to invest capital in advertising strategy in
states like California and Colorado because of the level of consumption
of beer. We don’t have selling information however, we can notice by the
wide assortment of California that the demand of beer is really high and
more importantly the customers are willing to purchase more style of
beers. On the other side, it doesn’t make sense to invest too much money
in States like Dakota because it seems that demand of beers is very low.
In terms of Inventory Management, it is recommendable to keep a high
service level and a good safety stock in states like California or
Colorado aiming to provide a great customer service. We have to prevent
getting stock out in those states since it seems they bring the most
profit to the company.</p>
</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
